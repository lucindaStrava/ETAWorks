{"paragraphs":[{"text":"valimport com.strava.hetchy.schemas.activitystreamset.{ActivityStreamSetRaw, StreamTypes}\n\nimport org.apache.spark.sql.{DataFrame, Dataset, SaveMode}\nimport org.apache.spark.sql.functions.{lit}\n\nimport spark.implicits._\n\n","user":"anonymous","dateUpdated":"2019-11-26T18:54:19+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.strava.hetchy.schemas.activitystreamset.{ActivityStreamSetRaw, StreamTypes}\nimport org.apache.spark.sql.{DataFrame, Dataset, SaveMode}\nimport org.apache.spark.sql.functions.lit\nimport spark.implicits._\ndefined class LatLng\ndefined class SimpleStream\ndefined class EdgeStat\ndefined class JoinedStream\ndefined class FinalStream\n"}]},"apps":[],"jobName":"paragraph_1574277228658_719974465","id":"20191120-191348_1752848390","dateCreated":"2019-11-20T19:13:48+0000","dateStarted":"2019-11-25T19:01:24+0000","dateFinished":"2019-11-25T19:01:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:83822"},{"text":"// sanity check on edgeAlign data\nval alignPath = \"s3a://strava.scratch/gbm/bay-area/perEdgeTraversalStream/\"\n\nval df = spark.read.load(alignPath)\ndf.printSchema","user":"anonymous","dateUpdated":"2020-01-02T18:12:27+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1577988744172_-1331154014","id":"20200102-181224_848354757","dateCreated":"2020-01-02T18:12:24+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:83823"},{"text":"\ndf.createOrReplaceTempView(\"alignBayArea\")\n\nval myQuery = \"\"\"\nselect \ncount(1) / 1e6\nfrom alignBayArea\nwhere activityType = 'Run'\nand meanDistance > 1 and meanDistance < 100\nand meanDistance is not null\nand elapsedTime > 1 and elapsedTime < 500\nand elapsedTime is not null\nand meanSpeed > 0.3 and meanSpeed < 13\nand meanSpeed is not null\nand coverage > 0.9 and coverage <=1\nand coverage is not null\n\"\"\"\nval stat1 = spark.sql(myQuery).collect()\n\n// 193mill after the filtering","user":"anonymous","dateUpdated":"2020-01-02T18:12:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"alignPath: String = s3a://strava.scratch/gbm/bay-area/alignment/\nmyQuery: String =\n\"\nselect\ncount(1) / 1e6\nfrom alignBayArea\nwhere activityType = 'Run'\nand meanDistance > 1 and meanDistance < 100\nand meanDistance is not null\nand elapsedTime > 1 and elapsedTime < 500\nand elapsedTime is not null\nand meanSpeed > 0.3 and meanSpeed < 13\nand meanSpeed is not null\nand coverage > 0.9 and coverage <=1\nand coverage is not null\n\"\nstat1: Array[org.apache.spark.sql.Row] = Array([193.134820])\n"}]},"apps":[],"jobName":"paragraph_1574285662983_-332433222","id":"20191120-213422_2035546441","dateCreated":"2019-11-20T21:34:22+0000","dateStarted":"2019-11-21T21:28:15+0000","dateFinished":"2019-11-21T21:29:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:83824"},{"text":"val myQuery = \"\"\"\nselect \napprox_percentile(meanSpeed, 0.01),\napprox_percentile(meanSpeed, 0.1),\napprox_percentile(meanSpeed, 0.5),\napprox_percentile(meanSpeed, 0.9),\napprox_percentile(meanSpeed, 0.99),\n\napprox_percentile(meanDistance, 0.01),\napprox_percentile(meanDistance, 0.1),\napprox_percentile(meanDistance, 0.5),\napprox_percentile(meanDistance, 0.9),\napprox_percentile(meanDistance, 0.99),\n\napprox_percentile(elapsedTime, 0.01),\napprox_percentile(elapsedTime, 0.1),\napprox_percentile(elapsedTime, 0.5),\napprox_percentile(elapsedTime, 0.9),\napprox_percentile(elapsedTime, 0.99),\n\napprox_percentile(coverage, 0.01),\napprox_percentile(coverage, 0.1),\napprox_percentile(coverage, 0.5),\napprox_percentile(coverage, 0.9),\napprox_percentile(coverage, 0.99)\n\nfrom alignBayArea\nwhere activityType = 'Run'\n\"\"\"\nval data1 = spark.sql(myQuery).collect()","user":"anonymous","dateUpdated":"2019-11-21T21:16:14+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"myQuery: String =\n\"\nselect\napprox_percentile(meanSpeed, 0.01),\napprox_percentile(meanSpeed, 0.1),\napprox_percentile(meanSpeed, 0.5),\napprox_percentile(meanSpeed, 0.9),\napprox_percentile(meanSpeed, 0.99),\n\napprox_percentile(meanDistance, 0.01),\napprox_percentile(meanDistance, 0.1),\napprox_percentile(meanDistance, 0.5),\napprox_percentile(meanDistance, 0.9),\napprox_percentile(meanDistance, 0.99),\n\napprox_percentile(elapsedTime, 0.01),\napprox_percentile(elapsedTime, 0.1),\napprox_percentile(elapsedTime, 0.5),\napprox_percentile(elapsedTime, 0.9),\napprox_percentile(elapsedTime, 0.99),\n\napprox_percentile(coverage, 0.01),\napprox_percentile(coverage, 0.1),\napprox_percentile(coverage, 0.5),\napprox_percentile(coverage, 0.9),\napprox_percentile(coverage, 0.99)\n\nfrom alignBayArea\nwhere activityType = ...data1: Array[org.apache.spark.sql.Row] = Array([0.6483836132086861,2.034081211700911,3.07136292899948,3.897245850754564,5.320008286790868,0.9847996750941385,2.9706371234411986,9.792662453047615,24.273105967732064,42.98282286220308,0.4279401728008452,2.4542907587792797,14.472205509759988,62.76597020933741,267.2595427691966,0.2209045088283884,1.0,1.0,1.0,1.0])\n"}]},"apps":[],"jobName":"paragraph_1574370699748_-958096728","id":"20191121-211139_1259032385","dateCreated":"2019-11-21T21:11:39+0000","dateStarted":"2019-11-21T21:16:14+0000","dateFinished":"2019-11-21T21:20:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:83825"},{"text":"val meanSpeedHis = data1.select(\"meanSpeed\").as[Double].rdd.histogram(20)\nval elapsedTimeHis = data1.select(\"elapsedTime\").as[Double].rdd.histogram(20)\nval coverageHis = data1.select(\"coverage\").as[Double].rdd.histogram(20)\nval meanDistanceHis = data1.select(\"meanDistance\").as[Double].rdd.histogram(20)\n","user":"anonymous","dateUpdated":"2019-11-21T21:33:21+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"meanSpeedHis: (Array[Double], Array[Long]) = (Array(0.3000002818945852, 0.9349952265234984, 1.5699901711524116, 2.2049851157813247, 2.839980060410238, 3.474975005039151, 4.109969949668064, 4.744964894296977, 5.37995983892589, 6.014954783554803, 6.649949728183716, 7.28494467281263, 7.919939617441543, 8.554934562070455, 9.18992950669937, 9.824924451328283, 10.459919395957195, 11.094914340586108, 11.72990928521502, 12.364904229843935, 12.999899174472848),Array(2594809, 7051787, 12490028, 45017254, 76606365, 38667890, 7966980, 1603999, 466135, 199081, 119809, 83840, 62379, 47104, 37140, 30493, 26780, 23667, 20755, 18525))\nelapsedTimeHis: (Array[Double], Array[Long]) = (Array(1.0000000785965995, 25.949985351794957, 50.899970624993315, 75.84995589819168, 100.79994117139003, 125.7499264445884, 150.69991171778676, 175.64989699098513, 200.59988226418346, 225.54986753738183, 250.4998528105802, 275.44983808377856, 300.3998233569769, 325.3498086301753, 350.29979390337365, 375.249779176572, 400.1997644497703, 425.14974972296875, 450.09973499616706, 475.0497202693655, 499.9997055425638),Array(130317930, 37371008, 11878862, 5054178, 2766495, 1686024, 1079145, 714707, 508704, 383153, 300931, 241466, 193338, 155857, 124801, 100654, 83554, 68769, 57035, 48209))\ncoverageHis: (Array[Double], Array[Long]) = (Array(0.900000142585209, 0.9050001354559486, 0.9100001283266881, 0.9150001211974277, 0.9200001140681672, 0.9250001069389068, 0.9300000998096463, 0.9350000926803859, 0.9400000855511254, 0.945000078421865, 0.9500000712926044, 0.955000064163344, 0.9600000570340836, 0.9650000499048231, 0.9700000427755627, 0.9750000356463022, 0.9800000285170418, 0.9850000213877813, 0.9900000142585209, 0.9950000071292604, 1.0),Array(71206, 71506, 68867, 69561, 72160, 72777, 74225, 74617, 75759, 76917, 76923, 78176, 78609, 78740, 79758, 78647, 78918, 77855, 76383, 191703216))\nmeanDistanceHis: (Array[Double], Array[Long]) = (Array(1.0000001077434506, 5.949998370480009, 10.899996633216567, 15.849994895953127, 20.799993158689684, 25.74999142142624, 30.6999896841628, 35.649987946899365, 40.59998620963592, 45.54998447237248, 50.499982735109036, 55.44998099784559, 60.39997926058216, 65.3499775233187, 70.29997578605527, 75.24997404879181, 80.19997231152838, 85.14997057426494, 90.0999688370015, 95.04996709973805, 99.99996536247461),Array(55356344, 50855469, 34454136, 23032035, 14110186, 7584298, 3775066, 1858593, 948511, 504283, 276808, 156034, 90327, 52250, 31267, 18967, 12025, 8030, 5762, 4429))\n"}]},"apps":[],"jobName":"paragraph_1574370074795_1897937708","id":"20191121-210114_946338326","dateCreated":"2019-11-21T21:01:14+0000","dateStarted":"2019-11-21T21:33:21+0000","dateFinished":"2019-11-21T21:46:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:83826"},{"text":"// take a look at one activity, order by streamStartPointer and see how each edge connects\nval alignSampleDF = spark.read.parquet(\"s3a://strava.scratch/gbm/bay-area/perEdgeTraversalStream/key=1890\")\nalignSampleDF.createOrReplaceTempView(\"alignSample\")\n\nval sampleEdges = spark.sql(\n    \"\"\"\n    select edgeUID, streamStartPointer, streamEndPointer, meanDistance, elapsedTime, meanSpeed, coverage, athleteId, startDateLocal from alignSample where activityId = xxxxxxxx\n    order by streamStartPointer\n    \"\"\"\n).collect()","user":"anonymous","dateUpdated":"2020-01-02T18:27:06+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"alignSampleDF: org.apache.spark.sql.DataFrame = [edgeID: bigint, edgeUID: bigint ... 19 more fields]\nsampleEdges: Array[org.apache.spark.sql.Row] = Array([-211481935,0.0,83.0,3.5437386952153243,108.0,4.277926675212476,0.8951809125831119,1522587,1.536479066E9], [211481914,83.0,84.68644177440186,9.898770784545867,1.6864417744018567,6.654182722255101,1.0,1522587,1.536479066E9], [211481916,84.68644183903835,105.27445648834693,5.208174912922964,20.588014649308562,8.55143539195271,1.0,1522587,1.536479066E9], [211481910,105.27445642778068,151.52734200209318,4.666678778891957,55.2528855743125,3.9069647700751964,1.0,1522587,1.536479066E9], [211481909,151.527343872935,167.0,6.591181616891296,15.472656127064994,5.9309157221948245,1.0,1522587,1.536479066E9], [211481951,167.0,212.0,8.963207277042535,45.0,5.391195602208755,1.0,1522587,1.536479066E9], [211481950,212.0,224.19755625608354,5.59636690287..."}]},"apps":[],"jobName":"paragraph_1574358280070_208575597","id":"20191121-174440_187496274","dateCreated":"2019-11-21T17:44:40+0000","dateStarted":"2019-11-21T22:53:19+0000","dateFinished":"2019-11-21T22:53:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:83827"},{"text":"print(sampleEdges.size)\nprint(sampleEdges(181))","user":"anonymous","dateUpdated":"2019-11-21T22:54:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"182[211481935,7019.0,7116.0,4.504971916162747,107.0,4.155449149411618,0.8847985849949812,1522587,1.536479066E9]"}]},"apps":[],"jobName":"paragraph_1574376803473_225288837","id":"20191121-225323_2111142611","dateCreated":"2019-11-21T22:53:23+0000","dateStarted":"2019-11-21T22:54:40+0000","dateFinished":"2019-11-21T22:54:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:83828"},{"text":"// raw stream schema for reference\nval streamSample = spark.read.load(\n    \"s3a://strava.hetchy/streams/activity_streams_raw/version_d16f4c7434524d6abaaad6c6a38bd12b/key=1820/part-00000-8966d4b9-3741-4dc8-b658-aac7ebd01d96-c000.snappy.parquet\")\nstreamSample.printSchema\n","user":"anonymous","dateUpdated":"2019-11-23T02:39:49+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"streamSample: org.apache.spark.sql.DataFrame = [id: bigint, _time: binary ... 7 more fields]\nroot\n |-- id: long (nullable = true)\n |-- _time: binary (nullable = true)\n |-- _latlng: binary (nullable = true)\n |-- _elevation: binary (nullable = true)\n |-- _cadence: binary (nullable = true)\n |-- _heartrate: binary (nullable = true)\n |-- _power: binary (nullable = true)\n |-- _temperature: binary (nullable = true)\n |-- attributes: struct (nullable = true)\n |    |-- id: long (nullable = true)\n |    |-- athleteId: integer (nullable = true)\n |    |-- activityType: string (nullable = true)\n |    |-- deviceType: integer (nullable = true)\n |    |-- startDate: timestamp (nullable = true)\n |    |-- startDateLocal: timestamp (nullable = true)\n |    |-- distance: double (nullable = true)\n |    |-- elevGain: double (nullable = true)\n |    |-- startLat: double (nullable = true)\n |    |-- startLng: double (nullable = true)\n |    |-- hasLocation: boolean (nullable = true)\n |    |-- isPrivate: boolean (nullable = true)\n |    |-- mapStartIndex: integer (nullable = true)\n |    |-- mapEndIndex: integer (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1574475558938_788209841","id":"20191123-021918_1002457782","dateCreated":"2019-11-23T02:19:18+0000","dateStarted":"2019-11-23T02:22:12+0000","dateFinished":"2019-11-23T02:22:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:83829"},{"text":"// joined stream\nval aa1 = spark.read.load(\n    s\"s3a://strava.scratch/gbm/bay-area/perEdgeTraversalStream/key=189[01234]\"\n    )\naa1.createOrReplaceTempView(\"testSample\")\n\n","user":"anonymous","dateUpdated":"2020-01-02T18:25:28+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"aa1: org.apache.spark.sql.DataFrame = [activityId: bigint, athleteId: bigint ... 10 more fields]\n"}]},"apps":[],"jobName":"paragraph_1574703988187_-482317805","id":"20191125-174628_562233880","dateCreated":"2019-11-25T17:46:28+0000","dateStarted":"2019-11-26T23:04:14+0000","dateFinished":"2019-11-26T23:04:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:83830"},{"text":"aa1.printSchema","user":"anonymous","dateUpdated":"2019-11-26T23:04:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- activityId: long (nullable = true)\n |-- athleteId: long (nullable = true)\n |-- edgeUID: long (nullable = true)\n |-- activityType: integer (nullable = true)\n |-- meanDistance: double (nullable = true)\n |-- elapsedTime: double (nullable = true)\n |-- meanSpeed: double (nullable = true)\n |-- speedFeatures: array (nullable = true)\n |    |-- element: double (containsNull = true)\n |-- elevationFeatures: array (nullable = true)\n |    |-- element: double (containsNull = true)\n |-- cadenceFeatures: array (nullable = true)\n |    |-- element: double (containsNull = true)\n |-- heartrateFeatures: array (nullable = true)\n |    |-- element: double (containsNull = true)\n |-- powerFeatures: array (nullable = true)\n |    |-- element: double (containsNull = true)\n\n"}]},"apps":[],"jobName":"paragraph_1574809479968_1601201289","id":"20191126-230439_1489769533","dateCreated":"2019-11-26T23:04:39+0000","dateStarted":"2019-11-26T23:04:46+0000","dateFinished":"2019-11-26T23:04:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:83831"},{"text":"spark.sql(\"select meanSpeed, speedFeatures[4] from testSample\").take(10)","user":"anonymous","dateUpdated":"2019-11-27T17:41:59+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res4: Array[org.apache.spark.sql.Row] = Array([3.652965666771287,3.304154472449382], [6.242084486141314,6.569430968197083], [5.720165867502194,6.664844858382441], [3.4028666138769825,2.6990395797677484], [2.9952854787729106,3.0902641145795164], [2.539963745893221,3.8514097090548214], [8.086010019344625,8.407720705766181], [3.9615477284820737,6.455370683887732], [6.713949665362141,5.006752934672295], [8.592933821203072,7.219694243592621])\n"}]},"apps":[],"jobName":"paragraph_1574876386648_-297141108","id":"20191127-173946_1245119982","dateCreated":"2019-11-27T17:39:46+0000","dateStarted":"2019-11-27T17:41:59+0000","dateFinished":"2019-11-27T17:42:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:83832"},{"text":"val mySql =\n\n    \"\"\"\n      select edgeUID, count(1) as totalTraversals,\napprox_percentile(meanDistance, 0.1) as meanD_p10,\napprox_percentile(meanDistance, 0.5) as meanD_p50,\napprox_percentile(meanDistance, 0.9) as meanD_p90,\n\napprox_percentile(elapsedTime, 0.1) as t_p10,\napprox_percentile(elapsedTime, 0.5) as t_p50,\napprox_percentile(elapsedTime, 0.9) as t_p90,\n\napprox_percentile(meanSpeed, 0.1) as meanS_p10,\napprox_percentile(meanSpeed, 0.5) as meanS_p50,\napprox_percentile(meanSpeed, 0.9) as meanS_p90,\n\n  approx_percentile(speedFeatures[0], 0.1) as startS_p10,\napprox_percentile(speedFeatures[0], 0.5) as startS_p50,\napprox_percentile(speedFeatures[0], 0.9) as startS_p90,\n\n  approx_percentile(speedFeatures[1], 0.1) as endS_p10,\napprox_percentile(speedFeatures[1], 0.5) as endS_p50,\napprox_percentile(speedFeatures[1], 0.9) as endS_p90,\n\n  approx_percentile(speedFeatures[2], 0.1) as minS_p10,\napprox_percentile(speedFeatures[2], 0.5) as minS_p50,\napprox_percentile(speedFeatures[2], 0.9) as minS_p90,\n\n  approx_percentile(speedFeatures[3], 0.1) as maxS_p10,\napprox_percentile(speedFeatures[3], 0.5) as maxS_p50,\napprox_percentile(speedFeatures[3], 0.9) as maxS_p90,\n\n  approx_percentile(speedFeatures[4], 0.1) as meanSS_p10,\napprox_percentile(speedFeatures[4], 0.5) as meanSS_p50,\napprox_percentile(speedFeatures[4], 0.9) as meanSS_p90,\n\n  approx_percentile(speedFeatures[5], 0.1) as stdS_p10,\napprox_percentile(speedFeatures[5], 0.5) as stdS_p50,\napprox_percentile(speedFeatures[5], 0.9) as stdS_p90,\n\napprox_percentile(elevationFeatures[0], 0.5) as startE_p50,\napprox_percentile(elevationFeatures[1], 0.5) as endE_p50,\napprox_percentile(elevationFeatures[2], 0.5) as minE_p50,\napprox_percentile(elevationFeatures[3], 0.5) as maxE_p50,\napprox_percentile(elevationFeatures[4], 0.5) as meanE_p50,\napprox_percentile(elevationFeatures[5], 0.5) as stdE_p50,\n\n  approx_percentile(cadenceFeatures[0], 0.1) as startC_p10,\napprox_percentile(cadenceFeatures[0], 0.5) as startC_p50,\napprox_percentile(cadenceFeatures[0], 0.9) as startC_p90,\n\n  approx_percentile(cadenceFeatures[1], 0.1) as endC_p10,\napprox_percentile(cadenceFeatures[1], 0.5) as endC_p50,\napprox_percentile(cadenceFeatures[1], 0.9) as endC_p90,\n\n  approx_percentile(cadenceFeatures[2], 0.1) as minC_p10,\napprox_percentile(cadenceFeatures[2], 0.5) as minC_p50,\napprox_percentile(cadenceFeatures[2], 0.9) as minC_p90,\n\n  approx_percentile(cadenceFeatures[3], 0.1) as maxC_p10,\napprox_percentile(cadenceFeatures[3], 0.5) as maxC_p50,\napprox_percentile(cadenceFeatures[3], 0.9) as maxC_p90,\n\n  approx_percentile(cadenceFeatures[4], 0.1) as meanC_p10,\napprox_percentile(cadenceFeatures[4], 0.5) as meanC_p50,\napprox_percentile(cadenceFeatures[4], 0.9) as meanC_p90,\n\n  approx_percentile(cadenceFeatures[5], 0.1) as stdC_p10,\napprox_percentile(cadenceFeatures[5], 0.5) as stdC_p50,\napprox_percentile(cadenceFeatures[5], 0.9) as stdC_p90,\n\n  approx_percentile(heartrateFeatures[0], 0.1) as startH_p10,\napprox_percentile(heartrateFeatures[0], 0.5) as startH_p50,\napprox_percentile(heartrateFeatures[0], 0.9) as startH_p90,\n\n  approx_percentile(heartrateFeatures[1], 0.1) as endH_p10,\napprox_percentile(heartrateFeatures[1], 0.5) as endH_p50,\napprox_percentile(heartrateFeatures[1], 0.9) as endH_p90,\n\n  approx_percentile(heartrateFeatures[2], 0.1) as minH_p10,\napprox_percentile(heartrateFeatures[2], 0.5) as minH_p50,\napprox_percentile(heartrateFeatures[2], 0.9) as minH_p90,\n\n  approx_percentile(heartrateFeatures[3], 0.1) as maxH_p10,\napprox_percentile(heartrateFeatures[3], 0.5) as maxH_p50,\napprox_percentile(heartrateFeatures[3], 0.9) as maxH_p90,\n\n  approx_percentile(heartrateFeatures[4], 0.1) as meanH_p10,\napprox_percentile(heartrateFeatures[4], 0.5) as meanH_p50,\napprox_percentile(heartrateFeatures[4], 0.9) as meanH_p90,\n\n  approx_percentile(heartrateFeatures[5], 0.1) as stdH_p10,\napprox_percentile(heartrateFeatures[5], 0.5) as stdH_p50,\napprox_percentile(heartrateFeatures[5], 0.9) as stdH_p90\n\n\nfrom testSample\ngroup by edgeUID\n\n    \"\"\".stripMargin\n\nval bb = spark.sql(mySql).take(100)\n","user":"anonymous","dateUpdated":"2019-11-26T23:12:20+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"mySql: String =\n\"\n      select edgeUID, count(1) as totalTraversals,\napprox_percentile(meanDistance, 0.1) as meanD_p10,\napprox_percentile(meanDistance, 0.5) as meanD_p50,\napprox_percentile(meanDistance, 0.9) as meanD_p90,\n\napprox_percentile(elapsedTime, 0.1) as t_p10,\napprox_percentile(elapsedTime, 0.5) as t_p50,\napprox_percentile(elapsedTime, 0.9) as t_p90,\n\napprox_percentile(meanSpeed, 0.1) as meanS_p10,\napprox_percentile(meanSpeed, 0.5) as meanS_p50,\napprox_percentile(meanSpeed, 0.9) as meanS_p90,\n\n  approx_percentile(speedFeatures[0], 0.1) as startS_p10,\napprox_percentile(speedFeatures[0], 0.5) as startS_p50,\napprox_percentile(speedFeatures[0], 0.9) as startS_p90,\n\n  approx_percentile(speedFeatures[1], 0.1) as endS_p10,\napprox_percentile(speedFeatures[1], 0.5) as endS_p50,\napprox_pe...bb: Array[org.apache.spark.sql.Row] = Array([-212256813,2,2.0772593416122773,2.0772593416122773,3.119261386449405,2.3113781899119203,2.3113781899119203,2.704997904611446,5.5466604418829135,5.5466604418829135,6.098133219074647,7.550134776878729,7.550134776878729,8.467105758321448,7.07779248917945,7.07779248917945,7.781405268678119,7.07779248917945,7.07779248917945,7.781405268678119,7.550134776878729,7.550134776878729,8.467105758321448,7.371714385769826,7.371714385769826,8.025115252895107,0.1802401919120967,0.1802401919120967,0.2733479674665406,69.0,69.4,69.0,69.4,69.15,0.08660254038201452,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,135.0,135.0,139.0,136.0,136.0,140.0,135.0,135.0,139.0,136.0,136.0,140.0,135.5,135.5,139.5,0.5,0.5,0.5], [-212252..."}]},"apps":[],"jobName":"paragraph_1574718194164_2018957376","id":"20191125-214314_1167587228","dateCreated":"2019-11-25T21:43:14+0000","dateStarted":"2019-11-26T23:12:20+0000","dateFinished":"2019-11-26T23:13:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:83833"},{"text":"bb(0)","user":"anonymous","dateUpdated":"2019-11-26T23:13:31+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res3: org.apache.spark.sql.Row = [-212256813,2,2.0772593416122773,2.0772593416122773,3.119261386449405,2.3113781899119203,2.3113781899119203,2.704997904611446,5.5466604418829135,5.5466604418829135,6.098133219074647,7.550134776878729,7.550134776878729,8.467105758321448,7.07779248917945,7.07779248917945,7.781405268678119,7.07779248917945,7.07779248917945,7.781405268678119,7.550134776878729,7.550134776878729,8.467105758321448,7.371714385769826,7.371714385769826,8.025115252895107,0.1802401919120967,0.1802401919120967,0.2733479674665406,69.0,69.4,69.0,69.4,69.15,0.08660254038201452,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,135.0,135.0,139.0,136.0,136.0,140.0,135.0,135.0,139.0,136.0,136.0,140.0,135.5,135.5,139.5,0.5,0.5,0.5]\n"}]},"apps":[],"jobName":"paragraph_1574718259825_1616446769","id":"20191125-214419_30213470","dateCreated":"2019-11-25T21:44:19+0000","dateStarted":"2019-11-26T23:13:31+0000","dateFinished":"2019-11-26T23:13:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:83834"},{"text":"val cc = aa1.limitcc(10).as[FinalStream].collect","user":"anonymous","dateUpdated":"2019-11-26T18:55:24+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"cc: Array[FinalStream] = Array(FinalStream(1890111661,17121730,-211925227,1236.7859289862229,1252.2942799293987,15.096653293909991,21.274030519568214,4.454874493998896,1.0,1.538894191E9,Some([D@3e08b76d),Some([D@5e66780c),Some([D@16c016ad),None,None,None), FinalStream(1890111661,17121730,211925619,1319.0,1386.9855867399017,10.061388804952237,70.98558673990169,5.722931068731896,1.0,1.538894191E9,Some([D@6a42dd25),Some([D@118abcdf),Some([D@7c4100fa),None,None,None), FinalStream(1890111661,17121730,-211933114,678.6318069053533,806.6745392699764,3.2273910987793575,132.71727163459957,6.586042336859449,1.0,1.538894191E9,Some([D@6a2204a1),Some([D@16f55735),Some([D@52dd7d70),None,None,None), FinalStream(1890111661,17121730,211925570,1386.9856080013644,1412.6671786086147,7.9346774977120464,25.68..."}]},"apps":[],"jobName":"paragraph_1574719481154_-240050757","id":"20191125-220441_356436661","dateCreated":"2019-11-25T22:04:41+0000","dateStarted":"2019-11-26T18:55:14+0000","dateFinished":"2019-11-26T18:55:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:83835"},{"text":"cc(2).elapsedTime\ncc(2).time.get(0)\ncc(2).time.get(cc(2).time.get.size - 1)","user":"anonymous","dateUpdated":"2019-11-26T18:56:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res411: Double = 132.71727163459957\nres412: Double = 882.0\nres413: Double = 1014.0\n"}]},"apps":[],"jobName":"paragraph_1574794503823_-1299996365","id":"20191126-185503_183021808","dateCreated":"2019-11-26T18:55:03+0000","dateStarted":"2019-11-26T18:56:40+0000","dateFinished":"2019-11-26T18:56:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:83836"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1574796734086_-898900215","id":"20191126-193214_1437219694","dateCreated":"2019-11-26T19:32:14+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:83837"}],"name":"/lucindaz/edgeAlignExplore","id":"2ERYDG6KB","noteParams":{},"noteForms":{},"angularObjects":{"snowflake:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}