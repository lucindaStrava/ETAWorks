{"paragraphs":[{"text":"\nimport org.apache.spark.ml.linalg.{DenseVector, Vector, Vectors}\nimport org.apache.spark.ml.{Pipeline, PipelineModel}\nimport org.apache.spark.ml.regression.{GBTRegressionModel, GBTRegressor}\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.SaveMode\n\nimport spark.implicits._\n\n// to install dmlc package in docker\n// import ml.dmlc.xgboost4j.scala.spark.XGBoostRegressor\n","user":"anonymous","dateUpdated":"2020-01-10T22:31:07+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"<console>:1: error: ';' expected but 'import' found.\n0.1 import org.apache.spark.ml.linalg.{DenseVector, Vector, Vectors}\n    ^\n"}]},"apps":[],"jobName":"paragraph_1577134479095_-190813867","id":"20191205-212302_1535408969","dateCreated":"2019-12-23T20:54:39+0000","dateStarted":"2020-01-09T22:04:59+0000","dateFinished":"2020-01-09T22:04:59+0000","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:98298"},{"text":"// we load v0.1 features and only select top 200 features based on importance rank\n\n  val trainData = spark.read.load(s\"s3a://strava.scratch/gbm/bay-area/etaTrainingDataV0p1/part-0000*.parquet\")\n  val valData = spark.read.load(s\"s3a://strava.scratch/gbm/bay-area/etaValidationDataV0p1\")\n  \n  trainData.printSchema","user":"anonymous","dateUpdated":"2020-01-06T17:42:25+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"trainData: org.apache.spark.sql.DataFrame = [edgeUID: bigint, athleteId: bigint ... 3 more fields]\nvalData: org.apache.spark.sql.DataFrame = [edgeUID: bigint, athleteId: bigint ... 3 more fields]\nroot\n |-- edgeUID: long (nullable = true)\n |-- athleteId: long (nullable = true)\n |-- best_effort: double (nullable = true)\n |-- label: double (nullable = true)\n |-- features: vector (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1577134479098_-1227101417","id":"20191205-212312_1461850965","dateCreated":"2019-12-23T20:54:39+0000","dateStarted":"2020-01-05T03:29:10+0000","dateFinished":"2020-01-05T03:29:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98299"},{"text":"val idxes = Array(\n    0, 1, 2, 7, 5, 8, 4, 3, 71, 14, 11, 6, 17, 34, 28, 70, 13, 9, 16, 12, 214, 10, 19, 20, 27, 29, 53, 62, 74, 22, 18, 68, 26, 15, 52, 46, 23, 213, 21, 210, 72, 35, 54, 50, 56, 55, 69, 51, 30, 211, 235, 47, 38, 59, 239, 240, 64, 44, 165, 129, 200, 63, 40, 234, 37, 169, 99, 140, 45, 49, 143, 233, 58, 65, 25, 130, 164, 212, 61, 241, 105, 204, 111, 144, 48, 57, 217, 161, 178, 145, 163, 199, 60, 209, 170, 231, 207, 128, 205, 110,\n    36, 41, 175, 179, 67, 101, 230, 146, 139, 305, 147, 171, 198, 160, 100, 102, 24, 43, 304, 141, 180, 134, 208, 137, 138, 172, 39, 232, 31, 142, 66, 206, 108, 195, 32, 103, 126, 135, 310, 181, 177, 215, 104, 216, 174, 112, 162, 83, 303, 196, 270, 176, 182, 136, 268, 93, 42, 91, 125, 280, 107, 309, 87, 286, 109, 106, 269, 311, 173, 85, 197, 95, 283, 127, 301, 86, 92, 33, 97, 300, 287, 116, 96, 275, 279, 282, 284, 225, 84, 242, 251, 149, 148, 157, 114, 219, 227, 302, 222, 285\n    )\n    \nimport java.util.Arrays\n\nimport org.apache.spark.ml.attribute.{Attribute, AttributeGroup, NumericAttribute}\nimport org.apache.spark.ml.feature.VectorSlicer\nimport org.apache.spark.ml.linalg.Vectors\nimport org.apache.spark.sql.{Row, SparkSession}\nimport org.apache.spark.sql.types.StructType\n\n\nval slicer = new VectorSlicer().setInputCol(\"features\").setOutputCol(\"slicedFeatures\")\n\nslicer.setIndices(idxes)\n","user":"anonymous","dateUpdated":"2020-01-05T03:29:23+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"idxes: Array[Int] = Array(0, 1, 2, 7, 5, 8, 4, 3, 71, 14, 11, 6, 17, 34, 28, 70, 13, 9, 16, 12, 214, 10, 19, 20, 27, 29, 53, 62, 74, 22, 18, 68, 26, 15, 52, 46, 23, 213, 21, 210, 72, 35, 54, 50, 56, 55, 69, 51, 30, 211, 235, 47, 38, 59, 239, 240, 64, 44, 165, 129, 200, 63, 40, 234, 37, 169, 99, 140, 45, 49, 143, 233, 58, 65, 25, 130, 164, 212, 61, 241, 105, 204, 111, 144, 48, 57, 217, 161, 178, 145, 163, 199, 60, 209, 170, 231, 207, 128, 205, 110, 36, 41, 175, 179, 67, 101, 230, 146, 139, 305, 147, 171, 198, 160, 100, 102, 24, 43, 304, 141, 180, 134, 208, 137, 138, 172, 39, 232, 31, 142, 66, 206, 108, 195, 32, 103, 126, 135, 310, 181, 177, 215, 104, 216, 174, 112, 162, 83, 303, 196, 270, 176, 182, 136, 268, 93, 42, 91, 125, 280, 107, 309, 87, 286, 109, 106, 269, 311, 173, 85, 197, 95, 2...import java.util.Arrays\nimport org.apache.spark.ml.attribute.{Attribute, AttributeGroup, NumericAttribute}\nimport org.apache.spark.ml.feature.VectorSlicer\nimport org.apache.spark.ml.linalg.Vectors\nimport org.apache.spark.sql.{Row, SparkSession}\nimport org.apache.spark.sql.types.StructType\nslicer: org.apache.spark.ml.feature.VectorSlicer = vectorSlicer_32045b4dbecc\nres2: slicer.type = vectorSlicer_32045b4dbecc\n"}]},"apps":[],"jobName":"paragraph_1577134906183_-1070866487","id":"20191223-210146_351579767","dateCreated":"2019-12-23T21:01:46+0000","dateStarted":"2020-01-05T03:29:23+0000","dateFinished":"2020-01-05T03:29:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98300"},{"text":"// val x = slicer.transform(trainData).select(\"slicedFeatures\").take(1)(0)\n// x(0).asInstanceOf[Vector].size","user":"anonymous","dateUpdated":"2019-12-23T21:13:20+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"x: org.apache.spark.sql.Row = [[1.0,663.0,5.15205055649304,9.920926210558264,4.85391718367282,2.7585769527929203,35.136623344104606,16.017715925779747,34.0,2.472880482740337,2.4383806971332715,6.785241559553242,1.7709526552669355,0.09999999999995453,1.2783375420997185,2.449489742783178,5.477355978150972,3.644504897002809,4.970892417053647,3.6104330866297967,3.0425082840740743,4.677527027904693,4.090986320665247,3.15598230359053,0.41063602335719057,12.5,121.0,124.0,190.0,6.9454612906600515,3.064483250644302,0.0,0.07315733485811207,3.5855437518848357,2.5860201081971503,93.0,2.751263041421157,2.214356682,4.198158928329535,2.652471083,1.0,80.0,145.0,0.0,122.0,165.0,0.5,0.5,12.200000000000001,3.1863175263580246,-0.5126772867202039,79.57142857142857,81.0,120.0,14.0,3.799999952,166.0,82.0,-0.1..."}]},"apps":[],"jobName":"paragraph_1577135403441_1134187856","id":"20191223-211003_2050680809","dateCreated":"2019-12-23T21:10:03+0000","dateStarted":"2019-12-23T21:11:36+0000","dateFinished":"2019-12-23T21:11:38+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98301"},{"text":"  def getPipeline(): Pipeline = {\n    val gbt = new GBTRegressor().\n      setLabelCol(\"label\").\n      setFeaturesCol(\"slicedFeatures\").\n      setMaxDepth(10).\n      setMaxIter(300).\n      setSubsamplingRate(0.7).\n      setLossType(\"squared\").\n      setPredictionCol(\"ETA\").\n      setStepSize(0.05).setCheckpointInterval(40)\n\n    new Pipeline().setStages(Array(slicer, gbt))\n  }\n  \n  val modelPipeline = getPipeline.fit(trainData)","user":"anonymous","dateUpdated":"2020-01-05T03:29:43+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"getPipeline: ()org.apache.spark.ml.Pipeline\nmodelPipeline: org.apache.spark.ml.PipelineModel = pipeline_ed69c3480156\n"}]},"apps":[],"jobName":"paragraph_1577134479101_332978151","id":"20191205-221242_234646968","dateCreated":"2019-12-23T20:54:39+0000","dateStarted":"2020-01-05T03:29:43+0000","dateFinished":"2020-01-05T08:40:28+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98302"},{"text":"val path = s\"s3a://strava.scratch/gbm/bay-area/etaModel/version0.2.1\"\nmodelPipeline.write.overwrite().save(path)\n","user":"anonymous","dateUpdated":"2020-01-05T03:29:53+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"path: String = s3a://strava.scratch/gbm/bay-area/etaModel/version0.2.1\n"}]},"apps":[],"jobName":"paragraph_1577134479103_-55878506","id":"20191205-225607_1320327919","dateCreated":"2019-12-23T20:54:39+0000","dateStarted":"2020-01-05T03:29:53+0000","dateFinished":"2020-01-05T08:40:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98303"},{"text":"val modelPipeline = PipelineModel.load(path)\n","user":"anonymous","dateUpdated":"2020-01-05T19:50:12+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"modelPipeline: org.apache.spark.ml.PipelineModel = pipeline_ed69c3480156\n"}]},"apps":[],"jobName":"paragraph_1577134479106_-1904408321","id":"20191223-173256_459783652","dateCreated":"2019-12-23T20:54:39+0000","dateStarted":"2020-01-05T19:50:12+0000","dateFinished":"2020-01-05T19:50:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98304"},{"text":"val trainResult = modelPipeline.transform(trainData).drop(\"features\").drop(\"slicedFeatures\")\nval valResult = modelPipeline.transform(valData).drop(\"features\").drop(\"slicedFeatures\")","user":"anonymous","dateUpdated":"2020-01-05T19:50:46+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"trainResult: org.apache.spark.sql.DataFrame = [edgeUID: bigint, athleteId: bigint ... 3 more fields]\nvalResult: org.apache.spark.sql.DataFrame = [edgeUID: bigint, athleteId: bigint ... 3 more fields]\n"}]},"apps":[],"jobName":"paragraph_1577134479109_-1342593360","id":"20191205-225514_903215923","dateCreated":"2019-12-23T20:54:39+0000","dateStarted":"2020-01-05T19:50:46+0000","dateFinished":"2020-01-05T19:50:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98305"},{"text":"trainResult.repartition(1).write.mode(SaveMode.Overwrite).option(\"compression\", \"gzip\").parquet(\"s3a://strava.scratch/gbm/bay-area/etaResult/version0.2.1/train\")\nvalResult.repartition(1).write.mode(SaveMode.Overwrite).option(\"compression\", \"gzip\").parquet(\"s3a://strava.scratch/gbm/bay-area/etaResult/version0.2.1/val\")","user":"anonymous","dateUpdated":"2020-01-05T19:51:10+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1577134479111_1374030038","id":"20191205-231623_2071117536","dateCreated":"2019-12-23T20:54:39+0000","dateStarted":"2020-01-05T19:51:10+0000","dateFinished":"2020-01-05T19:55:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98306"},{"text":"// plot distribution of error, grouped by is\nval trainResult = spark.read.load(\"s3a://strava.scratch/gbm/bay-area/etaResult/version0.2.1/train\")\ntrainResult.printSchema\ntrainResult.createOrReplaceTempView(\"train\")\n\nval valResult = spark.read.load(\"s3a://strava.scratch/gbm/bay-area/etaResult/version0.2.1/val\")\nvalResult.createOrReplaceTempView(\"val\")\n\n","user":"anonymous","dateUpdated":"2020-01-09T21:58:52+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"trainResult: org.apache.spark.sql.DataFrame = [edgeUID: bigint, athleteId: bigint ... 3 more fields]\nroot\n |-- edgeUID: long (nullable = true)\n |-- athleteId: long (nullable = true)\n |-- best_effort: double (nullable = true)\n |-- label: double (nullable = true)\n |-- ETA: double (nullable = true)\n\nvalResult: org.apache.spark.sql.DataFrame = [edgeUID: bigint, athleteId: bigint ... 3 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["true/jobs/job?id=4556","true/jobs/job?id=4556","true/jobs/job?id=4556","true/jobs/job?id=4556","true/jobs/job?id=4556","true/jobs/job?id=4557","true/jobs/job?id=4557","true/jobs/job?id=4557","true/jobs/job?id=4557","true/jobs/job?id=4557"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1577134479113_1537097002","id":"20191205-231756_1599132393","dateCreated":"2019-12-23T20:54:39+0000","dateStarted":"2020-01-09T21:58:52+0000","dateFinished":"2020-01-09T21:58:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98307"},{"text":"\nval mySql = \"\"\"\nselect\napprox_percentile(abs(ETA - label), 0.05) as p5,\napprox_percentile(abs(ETA - label), 0.1) as p10,\napprox_percentile(abs(ETA - label), 0.5) as p50,\napprox_percentile(abs(ETA - label), 0.9) as p90,\napprox_percentile(abs(ETA - label), 0.95) as p95\n\nfrom train\nwhere best_effort > 0.5\n\"\"\"\n\nspark.sql(mySql).collect()","user":"anonymous","dateUpdated":"2020-01-06T17:49:19+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"mySql: String =\n\"\nselect\napprox_percentile(abs(ETA - label), 0.05) as p5,\napprox_percentile(abs(ETA - label), 0.1) as p10,\napprox_percentile(abs(ETA - label), 0.5) as p50,\napprox_percentile(abs(ETA - label), 0.9) as p90,\napprox_percentile(abs(ETA - label), 0.95) as p95\n\nfrom train\nwhere best_effort > 0.5\n\"\nres6: Array[org.apache.spark.sql.Row] = Array([0.07072983709341951,0.14286699213313137,0.9638123026554943,4.778382219955304,7.393366797774478])\n"}]},"apps":[],"jobName":"paragraph_1577134479116_-2102461434","id":"20191206-222740_308512482","dateCreated":"2019-12-23T20:54:39+0000","dateStarted":"2020-01-06T17:49:19+0000","dateFinished":"2020-01-06T17:49:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98308"},{"text":"val mySql = \"\"\"\nselect\napprox_percentile(abs((ETA - label) * 100.0 / label), 0.05) as p5,\napprox_percentile(abs((ETA - label) * 100.0 / label), 0.1) as p10,\napprox_percentile(abs((ETA - label) * 100.0 / label), 0.5) as p50,\napprox_percentile(abs((ETA - label) * 100.0 / label), 0.9) as p90,\napprox_percentile(abs((ETA - label) * 100.0 / label), 0.95) as p95\n\nfrom train\nwhere best_effort > 0.5\n\"\"\"\n\nspark.sql(mySql).collect()","user":"anonymous","dateUpdated":"2020-01-09T22:02:04+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"mySql: String =\n\"\nselect\napprox_percentile(abs((ETA - label) * 100.0 / label), 0.05) as p5,\napprox_percentile(abs((ETA - label) * 100.0 / label), 0.1) as p10,\napprox_percentile(abs((ETA - label) * 100.0 / label), 0.5) as p50,\napprox_percentile(abs((ETA - label) * 100.0 / label), 0.9) as p90,\napprox_percentile(abs((ETA - label) * 100.0 / label), 0.95) as p95\n\nfrom train\nwhere best_effort > 0.5\n\"\nres7: Array[org.apache.spark.sql.Row] = Array([0.8331615728842872,1.6746376181911224,9.38716823648284,33.66112059212066,50.93801147984325])\n"}]},"apps":[],"jobName":"paragraph_1577134479119_-201205353","id":"20191223-181832_250465567","dateCreated":"2019-12-23T20:54:39+0000","dateStarted":"2020-01-06T17:49:24+0000","dateFinished":"2020-01-06T17:49:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98309"},{"text":"trainResult.printSchema","user":"anonymous","dateUpdated":"2020-01-09T21:35:39+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- edgeUID: long (nullable = true)\n |-- athleteId: long (nullable = true)\n |-- best_effort: double (nullable = true)\n |-- label: double (nullable = true)\n |-- ETA: double (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1578605716889_-1291532407","id":"20200109-213516_1705098113","dateCreated":"2020-01-09T21:35:16+0000","dateStarted":"2020-01-09T21:35:39+0000","dateFinished":"2020-01-09T21:35:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98310"},{"text":"spark.read.parquet(s\"s3a://strava.scratch/gbm/bay-area/edgeMeta\").createOrReplaceTempView(\"meta\")\n\nval myQuery = \"\"\"\nselect \nETA, label, meta.properties.length as length, best_effort,\ncase when meta.properties.length < 10 then 0\n     when meta.properties.length >=10 and meta.properties.length < 20 then 1\n    when meta.properties.length >=20 and meta.properties.length < 50 then 2\n     when meta.properties.length >=50 and meta.properties.length < 100 then 3\n     when meta.properties.length >=100 and meta.properties.length < 200 then 4\n    else 5 end\nAS bucket\nfrom val join meta on\nabs(val.edgeUID) = meta.id\nand best_effort > 0.5\n\n\"\"\"\nval df = spark.sql(myQuery)\ndf.cache()","user":"anonymous","dateUpdated":"2020-01-09T22:03:31+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"myQuery: String =\n\"\nselect\nETA, label, meta.properties.length as length, best_effort,\ncase when meta.properties.length < 10 then 0\n     when meta.properties.length >=10 and meta.properties.length < 20 then 1\n    when meta.properties.length >=20 and meta.properties.length < 50 then 2\n     when meta.properties.length >=50 and meta.properties.length < 100 then 3\n     when meta.properties.length >=100 and meta.properties.length < 200 then 4\n    else 5 end\nAS bucket\nfrom val join meta on\nabs(val.edgeUID) = meta.id\nand best_effort > 0.5\n\n\"\ndf: org.apache.spark.sql.DataFrame = [ETA: double, label: double ... 3 more fields]\nres37: df.type = [ETA: double, label: double ... 3 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["true/jobs/job?id=4630","true/jobs/job?id=4630","true/jobs/job?id=4630","true/jobs/job?id=4630","true/jobs/job?id=4630"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578605669044_-992801059","id":"20200109-213429_344106686","dateCreated":"2020-01-09T21:34:29+0000","dateStarted":"2020-01-09T22:03:31+0000","dateFinished":"2020-01-09T22:03:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98311"},{"text":"df.createOrReplaceTempView(\"buckets\")","user":"anonymous","dateUpdated":"2020-01-09T22:03:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1578607023008_-386024582","id":"20200109-215703_210868763","dateCreated":"2020-01-09T21:57:03+0000","dateStarted":"2020-01-09T22:03:36+0000","dateFinished":"2020-01-09T22:03:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98312"},{"text":"val myQuery = \"\"\"\nselect bucket, count(1)\nfrom buckets\ngroup by bucket\norder by bucket\n\"\"\"\nspark.sql(myQuery).collect","user":"anonymous","dateUpdated":"2020-01-09T22:03:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"myQuery: String =\n\"\nselect bucket, count(1)\nfrom buckets\ngroup by bucket\norder by bucket\n\"\nres39: Array[org.apache.spark.sql.Row] = Array([0,61194], [1,93254], [2,146623], [3,126326], [4,85546], [5,41204])\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["true/jobs/job?id=4635","true/jobs/job?id=4635","true/jobs/job?id=4635","true/jobs/job?id=4635","true/jobs/job?id=4635","true/jobs/job?id=4638","true/jobs/job?id=4638","true/jobs/job?id=4638","true/jobs/job?id=4638","true/jobs/job?id=4638"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578606997996_1556040774","id":"20200109-215637_1139186304","dateCreated":"2020-01-09T21:56:37+0000","dateStarted":"2020-01-09T22:03:42+0000","dateFinished":"2020-01-09T22:03:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98313"},{"text":"val myQuery = \"\"\"\nselect\napprox_percentile(abs(ETA - label), 0.5) as p50,\napprox_percentile(abs(ETA - label), 0.9) as p90,\napprox_percentile(abs(ETA - label), 0.95) as p95\n\nfrom buckets\nwhere bucket = 0\n\"\"\"\nspark.sql(myQuery).show\n","user":"anonymous","dateUpdated":"2020-01-09T22:05:23+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"myQuery: String =\n\"\nselect\napprox_percentile(abs(ETA - label), 0.5) as p50,\napprox_percentile(abs(ETA - label), 0.9) as p90,\napprox_percentile(abs(ETA - label), 0.95) as p95\n\nfrom buckets\nwhere bucket = 0\n\"\n+-----------------+------------------+-----------------+\n|              p50|               p90|              p95|\n+-----------------+------------------+-----------------+\n|0.283017831547431|0.7966533974851044|1.029595145025338|\n+-----------------+------------------+-----------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["true/jobs/job?id=4661","true/jobs/job?id=4661","true/jobs/job?id=4661","true/jobs/job?id=4661","true/jobs/job?id=4661"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578607177262_-663179096","id":"20200109-215937_749119642","dateCreated":"2020-01-09T21:59:37+0000","dateStarted":"2020-01-09T22:05:23+0000","dateFinished":"2020-01-09T22:05:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98314"},{"text":"val myQuery = \"\"\"\nselect\napprox_percentile(abs(ETA - label)/label, 0.5)*100 as p50,\napprox_percentile(abs(ETA - label)/label, 0.9)*100 as p90,\napprox_percentile(abs(ETA - label)/label, 0.95)*100 as p95\n\nfrom buckets\nwhere bucket = 0\n\"\"\"\nspark.sql(myQuery).show","user":"anonymous","dateUpdated":"2020-01-09T22:51:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"myQuery: String =\n\"\nselect\napprox_percentile(abs(ETA - label)/label, 0.5)*100 as p50,\napprox_percentile(abs(ETA - label)/label, 0.9)*100 as p90,\napprox_percentile(abs(ETA - label)/label, 0.95)*100 as p95\n\nfrom buckets\nwhere bucket = 0\n\"\n+------------------+-----------------+-----------------+\n|               p50|              p90|              p95|\n+------------------+-----------------+-----------------+\n|18.119129772324342|53.33842529678389|71.00998284297837|\n+------------------+-----------------+-----------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["true/jobs/job?id=5234","true/jobs/job?id=5234","true/jobs/job?id=5234","true/jobs/job?id=5234","true/jobs/job?id=5234"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578610283524_1872366213","id":"20200109-225123_1032950184","dateCreated":"2020-01-09T22:51:23+0000","dateStarted":"2020-01-09T22:51:36+0000","dateFinished":"2020-01-09T22:51:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98315"},{"text":"val myQuery = \"\"\"\nselect\napprox_percentile(abs(ETA - label)/label, 0.5)*100 as p50,\napprox_percentile(abs(ETA - label)/label, 0.9)*100 as p90,\napprox_percentile(abs(ETA - label)/label, 0.95)*100 as p95\n\nfrom buckets\nwhere bucket = 1\n\"\"\"\nspark.sql(myQuery).show","user":"anonymous","dateUpdated":"2020-01-09T22:51:02+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"myQuery: String =\n\"\nselect\napprox_percentile(abs(ETA - label)/label, 0.5)*100 as p50,\napprox_percentile(abs(ETA - label)/label, 0.9)*100 as p90,\napprox_percentile(abs(ETA - label)/label, 0.95)*100 as p95\n\nfrom buckets\nwhere bucket = 1\n\"\n+------------------+------------------+-----------------+\n|               p50|               p90|              p95|\n+------------------+------------------+-----------------+\n|14.909993853116557|53.743554010012126|82.76076228163245|\n+------------------+------------------+-----------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["true/jobs/job?id=5224","true/jobs/job?id=5224","true/jobs/job?id=5224","true/jobs/job?id=5224","true/jobs/job?id=5224"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578607523685_-675368565","id":"20200109-220523_1484544964","dateCreated":"2020-01-09T22:05:23+0000","dateStarted":"2020-01-09T22:51:02+0000","dateFinished":"2020-01-09T22:51:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98316"},{"text":"val myQuery = \"\"\"\nselect\napprox_percentile(abs(ETA - label)/label, 0.5)*100 as p50,\napprox_percentile(abs(ETA - label)/label, 0.9)*100 as p90,\napprox_percentile(abs(ETA - label)/label, 0.95)*100 as p95\n\nfrom buckets\nwhere bucket = 2\n\"\"\"\nspark.sql(myQuery).show","user":"anonymous","dateUpdated":"2020-01-09T22:51:59+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"myQuery: String =\n\"\nselect\napprox_percentile(abs(ETA - label)/label, 0.5)*100 as p50,\napprox_percentile(abs(ETA - label)/label, 0.9)*100 as p90,\napprox_percentile(abs(ETA - label)/label, 0.95)*100 as p95\n\nfrom buckets\nwhere bucket = 2\n\"\n+------------------+-----------------+-----------------+\n|               p50|              p90|              p95|\n+------------------+-----------------+-----------------+\n|10.164958039936495|33.92620716596397|52.41234922111748|\n+------------------+-----------------+-----------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["true/jobs/job?id=5238","true/jobs/job?id=5238","true/jobs/job?id=5238","true/jobs/job?id=5238","true/jobs/job?id=5238"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578607567915_117652174","id":"20200109-220607_74604816","dateCreated":"2020-01-09T22:06:07+0000","dateStarted":"2020-01-09T22:51:59+0000","dateFinished":"2020-01-09T22:52:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98317"},{"text":"val myQuery = \"\"\"\nselect\napprox_percentile(abs(ETA - label)/label, 0.5)*100 as p50,\napprox_percentile(abs(ETA - label)/label, 0.9)*100 as p90,\napprox_percentile(abs(ETA - label)/label, 0.95)*100 as p95\n\nfrom buckets\nwhere bucket = 3\n\"\"\"\nspark.sql(myQuery).show","user":"anonymous","dateUpdated":"2020-01-09T22:52:09+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"myQuery: String =\n\"\nselect\napprox_percentile(abs(ETA - label)/label, 0.5)*100 as p50,\napprox_percentile(abs(ETA - label)/label, 0.9)*100 as p90,\napprox_percentile(abs(ETA - label)/label, 0.95)*100 as p95\n\nfrom buckets\nwhere bucket = 3\n\"\n+-----------------+------------------+-----------------+\n|              p50|               p90|              p95|\n+-----------------+------------------+-----------------+\n|7.771471937161962|22.385937320070923|31.45107858943587|\n+-----------------+------------------+-----------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["true/jobs/job?id=5240","true/jobs/job?id=5240","true/jobs/job?id=5240","true/jobs/job?id=5240","true/jobs/job?id=5240"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578607573864_1149761840","id":"20200109-220613_1009657256","dateCreated":"2020-01-09T22:06:13+0000","dateStarted":"2020-01-09T22:52:09+0000","dateFinished":"2020-01-09T22:52:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98318"},{"text":"val myQuery = \"\"\"\nselect\napprox_percentile(abs(ETA - label)/label, 0.5)*100 as p50,\napprox_percentile(abs(ETA - label)/label, 0.9)*100 as p90,\napprox_percentile(abs(ETA - label)/label, 0.95)*100 as p95\n\nfrom buckets\nwhere bucket = 4\n\"\"\"\nspark.sql(myQuery).show","user":"anonymous","dateUpdated":"2020-01-09T22:52:20+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"myQuery: String =\n\"\nselect\napprox_percentile(abs(ETA - label)/label, 0.5)*100 as p50,\napprox_percentile(abs(ETA - label)/label, 0.9)*100 as p90,\napprox_percentile(abs(ETA - label)/label, 0.95)*100 as p95\n\nfrom buckets\nwhere bucket = 4\n\"\n+-----------------+------------------+-----------------+\n|              p50|               p90|              p95|\n+-----------------+------------------+-----------------+\n|6.572199732425922|18.624851986313676|25.44043290593503|\n+-----------------+------------------+-----------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["true/jobs/job?id=5244","true/jobs/job?id=5244","true/jobs/job?id=5244","true/jobs/job?id=5244","true/jobs/job?id=5244"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578607578437_447307607","id":"20200109-220618_1741073336","dateCreated":"2020-01-09T22:06:18+0000","dateStarted":"2020-01-09T22:52:20+0000","dateFinished":"2020-01-09T22:52:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98319"},{"text":"val myQuery = \"\"\"\nselect\napprox_percentile(abs(ETA - label)/label, 0.5)*100 as p50,\napprox_percentile(abs(ETA - label)/label, 0.9)*100 as p90,\napprox_percentile(abs(ETA - label)/label, 0.95)*100 as p95\n\nfrom buckets\nwhere bucket = 5\n\"\"\"\nspark.sql(myQuery).show","user":"anonymous","dateUpdated":"2020-01-09T22:52:31+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"myQuery: String =\n\"\nselect\napprox_percentile(abs(ETA - label)/label, 0.5)*100 as p50,\napprox_percentile(abs(ETA - label)/label, 0.9)*100 as p90,\napprox_percentile(abs(ETA - label)/label, 0.95)*100 as p95\n\nfrom buckets\nwhere bucket = 5\n\"\n+-----------------+-----------------+-----------------+\n|              p50|              p90|              p95|\n+-----------------+-----------------+-----------------+\n|6.316006003284991|17.72160967612176|23.87265901057956|\n+-----------------+-----------------+-----------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["true/jobs/job?id=5248","true/jobs/job?id=5248","true/jobs/job?id=5248","true/jobs/job?id=5248","true/jobs/job?id=5248"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578607586893_514852096","id":"20200109-220626_105976551","dateCreated":"2020-01-09T22:06:26+0000","dateStarted":"2020-01-09T22:52:31+0000","dateFinished":"2020-01-09T22:52:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:98320"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578607592441_-1951517602","id":"20200109-220632_1699065264","dateCreated":"2020-01-09T22:06:32+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:98321"}],"name":"lucindaz/edgeLevelModel_V0p2","id":"2EVRTPK4S","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}