{"paragraphs":[{"text":"import org.apache.spark.ml.{Pipeline, PipelineModel}\nimport org.apache.spark.sql.functions.{abs, col}\nimport org.apache.spark.sql.SaveMode\nimport spark.implicits._\n","user":"anonymous","dateUpdated":"2020-01-10T19:51:02+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.{Pipeline, PipelineModel}\nimport org.apache.spark.sql.functions.{abs, col}\nimport org.apache.spark.sql.SaveMode\nimport spark.implicits._\n"}]},"apps":[],"jobName":"paragraph_1578685549299_-1843017133","id":"20200106-182031_739474902","dateCreated":"2020-01-10T19:45:49+0000","dateStarted":"2020-01-10T19:51:03+0000","dateFinished":"2020-01-10T19:51:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:123161"},{"text":"val train = spark.read.parquet(s\"s3a://strava.scratch/gbm/bay-area/routeEtaTrainData/v0.1\").filter(\"routeDistance >= 3200\")\nval validation = spark.read.parquet(s\"s3a://strava.scratch/gbm/bay-area/routeEtaValidationData/v0.1\").filter(\"routeDistance >=3200\")\n","user":"anonymous","dateUpdated":"2020-01-10T20:13:47+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"train: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [activityId: bigint, athleteId: bigint ... 4 more fields]\nvalidation: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [activityId: bigint, athleteId: bigint ... 4 more fields]\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["true/jobs/job?id=3807","true/jobs/job?id=3807","true/jobs/job?id=3807","true/jobs/job?id=3807","true/jobs/job?id=3807","true/jobs/job?id=3808","true/jobs/job?id=3808","true/jobs/job?id=3808","true/jobs/job?id=3808","true/jobs/job?id=3808"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578685549328_-920712599","id":"20200107-174130_1860482675","dateCreated":"2020-01-10T19:45:49+0000","dateStarted":"2020-01-10T19:52:36+0000","dateFinished":"2020-01-10T19:52:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:123162"},{"text":"\nimport org.apache.spark.ml.regression.LinearRegression\n\n\n  def getLinearRegressionPipeline(): Pipeline = {\n\n    val lr = new LinearRegression().\n      setLabelCol(\"truth\").\n      setFeaturesCol(\"features\").\n      setPredictionCol(\"routeETA\").\n      setElasticNetParam(0.1).\n      setMaxIter(300)\n    new Pipeline().setStages(Array(lr))\n  }\n  \n  val modelPipeline = getLinearRegressionPipeline.fit(train)","user":"anonymous","dateUpdated":"2020-01-10T19:52:43+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.ml.regression.LinearRegression\ngetLinearRegressionPipeline: ()org.apache.spark.ml.Pipeline\nmodelPipeline: org.apache.spark.ml.PipelineModel = pipeline_b1389b967044\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["true/jobs/job?id=3809","true/jobs/job?id=3809","true/jobs/job?id=3809","true/jobs/job?id=3809","true/jobs/job?id=3809","true/jobs/job?id=3810","true/jobs/job?id=3810","true/jobs/job?id=3810","true/jobs/job?id=3810","true/jobs/job?id=3810","true/jobs/job?id=3811","true/jobs/job?id=3811","true/jobs/job?id=3811","true/jobs/job?id=3811","true/jobs/job?id=3811","true/jobs/job?id=3812","true/jobs/job?id=3812","true/jobs/job?id=3812","true/jobs/job?id=3812","true/jobs/job?id=3812","true/jobs/job?id=3813","true/jobs/job?id=3813","true/jobs/job?id=3813","true/jobs/job?id=3813","true/jobs/job?id=3813","true/jobs/job?id=3814","true/jobs/job?id=3814","true/jobs/job?id=3814","true/jobs/job?id=3814","true/jobs/job?id=3814"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578685549330_1919953488","id":"20200108-210904_1129159560","dateCreated":"2020-01-10T19:45:49+0000","dateStarted":"2020-01-10T19:52:43+0000","dateFinished":"2020-01-10T19:52:49+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:123163"},{"text":"val path = s\"s3a://strava.scratch/gbm/bay-area/routeEtaModel/v0.1.1\"\nmodelPipeline.write.overwrite().save(path)","user":"anonymous","dateUpdated":"2020-01-10T19:52:57+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"path: String = s3a://strava.scratch/gbm/bay-area/routeEtaModel/v0.1.1\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["true/jobs/job?id=3815","true/jobs/job?id=3815","true/jobs/job?id=3815","true/jobs/job?id=3815","true/jobs/job?id=3815","true/jobs/job?id=3816","true/jobs/job?id=3816","true/jobs/job?id=3816","true/jobs/job?id=3816","true/jobs/job?id=3816","true/jobs/job?id=3817","true/jobs/job?id=3817","true/jobs/job?id=3817","true/jobs/job?id=3817","true/jobs/job?id=3817"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578685549332_-1770980155","id":"20200108-214635_1148051843","dateCreated":"2020-01-10T19:45:49+0000","dateStarted":"2020-01-10T19:52:57+0000","dateFinished":"2020-01-10T19:53:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:123164"},{"text":"modelPipeline.transform(validation).drop(\"features\").repartition(1).\nwrite.mode(SaveMode.Overwrite).option(\"compression\", \"gzip\").\nparquet(s\"s3a://strava.scratch/gbm/bay-area/routeEtaResult/v0.1.1/validation\")","user":"anonymous","dateUpdated":"2020-01-10T19:53:10+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["true/jobs/job?id=3818","true/jobs/job?id=3818","true/jobs/job?id=3818","true/jobs/job?id=3818","true/jobs/job?id=3818"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578685549334_-365504931","id":"20200108-214736_257502140","dateCreated":"2020-01-10T19:45:49+0000","dateStarted":"2020-01-10T19:53:10+0000","dateFinished":"2020-01-10T19:53:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:123165"},{"text":"modelPipeline.transform(train).drop(\"features\").repartition(1).\nwrite.mode(SaveMode.Overwrite).option(\"compression\", \"gzip\").\nparquet(s\"s3a://strava.scratch/gbm/bay-area/routeEtaResult/v0.1.1/train\")","user":"anonymous","dateUpdated":"2020-01-10T19:53:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["true/jobs/job?id=3819","true/jobs/job?id=3819","true/jobs/job?id=3819","true/jobs/job?id=3819","true/jobs/job?id=3819"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578685549336_1013653467","id":"20200108-230605_624274298","dateCreated":"2020-01-10T19:45:49+0000","dateStarted":"2020-01-10T19:53:14+0000","dateFinished":"2020-01-10T19:53:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:123166"},{"text":"val validationDf = spark.read.load(s\"s3a://strava.scratch/gbm/bay-area/routeEtaResult/v0.1.1/validation\").\nwithColumnRenamed(\"routeDistance\",\"distance\").\nwithColumnRenamed(\"routeETA\", \"routeEstimation\")\n\nvalidationDf.printSchema\nvalidationDf.createOrReplaceTempView(\"validationResult\")","user":"anonymous","dateUpdated":"2020-01-10T20:22:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"validationDf: org.apache.spark.sql.DataFrame = [activityId: bigint, athleteId: bigint ... 4 more fields]\nroot\n |-- activityId: long (nullable = true)\n |-- athleteId: long (nullable = true)\n |-- distance: double (nullable = true)\n |-- numEdges: integer (nullable = true)\n |-- truth: double (nullable = true)\n |-- routeEstimation: double (nullable = true)\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["true/jobs/job?id=3860","true/jobs/job?id=3860","true/jobs/job?id=3860","true/jobs/job?id=3860","true/jobs/job?id=3860"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578685549338_1666702065","id":"20200108-230917_2120576542","dateCreated":"2020-01-10T19:45:49+0000","dateStarted":"2020-01-10T20:22:14+0000","dateFinished":"2020-01-10T20:22:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:123167"},{"text":"val myQuery = \"\"\"\nselect\n\napprox_percentile(  abs(routeEstimation-truth)/truth, 0.5)*100 as p50,\n\napprox_percentile(  abs(routeEstimation-truth)/truth, 0.9)*100 as p90,\napprox_percentile(   abs(routeEstimation-truth)/truth, 0.95)*100 as p95,\napprox_percentile(  abs(routeEstimation-truth)/truth,0.99)*100 as p99\n\nfrom validationResult\n\n\"\"\"\nspark.sql(myQuery).show","user":"anonymous","dateUpdated":"2020-01-10T20:22:18+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"myQuery: String =\n\"\nselect\n\napprox_percentile(  abs(routeEstimation-truth)/truth, 0.5)*100 as p50,\n\napprox_percentile(  abs(routeEstimation-truth)/truth, 0.9)*100 as p90,\napprox_percentile(   abs(routeEstimation-truth)/truth, 0.95)*100 as p95,\napprox_percentile(  abs(routeEstimation-truth)/truth,0.99)*100 as p99\n\nfrom validationResult\n\n\"\n+------------------+------------------+-----------------+-----------------+\n|               p50|               p90|              p95|              p99|\n+------------------+------------------+-----------------+-----------------+\n|5.8544474555590735|17.975399348650505|24.50192514024019|44.74690902009821|\n+------------------+------------------+-----------------+-----------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["true/jobs/job?id=3861","true/jobs/job?id=3861","true/jobs/job?id=3861","true/jobs/job?id=3861","true/jobs/job?id=3861"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578685549340_1611112282","id":"20200108-231106_340430311","dateCreated":"2020-01-10T19:45:49+0000","dateStarted":"2020-01-10T20:22:18+0000","dateFinished":"2020-01-10T20:22:19+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:123168"},{"text":"val myQuery = \"\"\"\nselect\n\n\napprox_percentile(  abs(routeEstimation-truth), 0.5)/60 as p50,\n\napprox_percentile(  abs(routeEstimation-truth), 0.9)/60 as p90,\napprox_percentile(   abs(routeEstimation-truth), 0.95)/60 as p95,\napprox_percentile(  abs(routeEstimation-truth),0.99)/60 as p99\n\nfrom validationResult\n\n\"\"\"\nspark.sql(myQuery).show","user":"anonymous","dateUpdated":"2020-01-10T20:22:20+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"myQuery: String =\n\"\nselect\n\n\napprox_percentile(  abs(routeEstimation-truth), 0.5)/60 as p50,\n\napprox_percentile(  abs(routeEstimation-truth), 0.9)/60 as p90,\napprox_percentile(   abs(routeEstimation-truth), 0.95)/60 as p95,\napprox_percentile(  abs(routeEstimation-truth),0.99)/60 as p99\n\nfrom validationResult\n\n\"\n+------------------+-----------------+------------------+------------------+\n|               p50|              p90|               p95|               p99|\n+------------------+-----------------+------------------+------------------+\n|2.1626079545617887|7.339627877198245|10.448957072554412|20.617211826482468|\n+------------------+-----------------+------------------+------------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["true/jobs/job?id=3862","true/jobs/job?id=3862","true/jobs/job?id=3862","true/jobs/job?id=3862","true/jobs/job?id=3862"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578685549342_-382409415","id":"20200108-231351_239110906","dateCreated":"2020-01-10T19:45:49+0000","dateStarted":"2020-01-10T20:22:20+0000","dateFinished":"2020-01-10T20:22:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:123169"},{"text":"\nval myQuery = \"\"\"\nselect \n*,\ncase when distance < 3200 then 0\n     when distance>=3200 and distance<8000 then 1\n    when distance>=8000 and distance<16000 then 2\n     when distance>=16000 and distance<20000 then 3\n    else 4 end\nAS bucket\nfrom validationResult\n\"\"\"\nval bucketDf = spark.sql(myQuery)\nbucketDf.cache()\nbucketDf.createOrReplaceTempView(\"buckets\")","user":"anonymous","dateUpdated":"2020-01-10T20:22:23+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"myQuery: String =\n\"\nselect\n*,\ncase when distance < 3200 then 0\n     when distance>=3200 and distance<8000 then 1\n    when distance>=8000 and distance<16000 then 2\n     when distance>=16000 and distance<20000 then 3\n    else 4 end\nAS bucket\nfrom validationResult\n\"\nbucketDf: org.apache.spark.sql.DataFrame = [activityId: bigint, athleteId: bigint ... 5 more fields]\nres42: bucketDf.type = [activityId: bigint, athleteId: bigint ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1578685549344_768671017","id":"20200108-231519_766162392","dateCreated":"2020-01-10T19:45:49+0000","dateStarted":"2020-01-10T20:22:23+0000","dateFinished":"2020-01-10T20:22:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:123170"},{"text":"spark.sql(\"\"\"\nselect bucket, count(1) from buckets\ngroup by bucket\norder by bucket\n\"\"\").collect","user":"anonymous","dateUpdated":"2020-01-10T20:22:26+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res44: Array[org.apache.spark.sql.Row] = Array([1,94177], [2,50066], [3,3774], [4,1882])\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["true/jobs/job?id=3863","true/jobs/job?id=3863","true/jobs/job?id=3863","true/jobs/job?id=3863","true/jobs/job?id=3863","true/jobs/job?id=3864","true/jobs/job?id=3864","true/jobs/job?id=3864","true/jobs/job?id=3864","true/jobs/job?id=3864"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578685549346_-455083964","id":"20200110-191743_1218568651","dateCreated":"2020-01-10T19:45:49+0000","dateStarted":"2020-01-10T20:22:26+0000","dateFinished":"2020-01-10T20:22:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:123171"},{"text":"val myQuery = \"\"\"\nwith b0 as (\nselect\napprox_percentile(abs(routeEstimation - truth)/truth, 0.5)*100 as p50,\n\napprox_percentile(abs(routeEstimation - truth)/truth, 0.9)*100 as p90,\napprox_percentile(abs(routeEstimation - truth)/truth, 0.95)*100 as p95,\napprox_percentile(abs(routeEstimation - truth)/truth, 0.99)*100 as p99,\n100 as name\n\nfrom buckets\nwhere bucket = 0\n),\n\nb1 as (\nselect\napprox_percentile(abs(routeEstimation - truth)/truth, 0.5)*100 as p50,\n\napprox_percentile(abs(routeEstimation - truth)/truth, 0.9)*100 as p90,\napprox_percentile(abs(routeEstimation - truth)/truth, 0.95)*100 as p95,\napprox_percentile(abs(routeEstimation - truth)/truth, 0.99)*100 as p99,\n100 as name\n\n\nfrom buckets\nwhere bucket = 1\n),\nb2 as (\nselect\napprox_percentile(abs(routeEstimation - truth)/truth, 0.5)*100 as p50,\n\napprox_percentile(abs(routeEstimation - truth)/truth, 0.9)*100 as p90,\napprox_percentile(abs(routeEstimation - truth)/truth, 0.95)*100 as p95,\napprox_percentile(abs(routeEstimation - truth)/truth, 0.99)*100 as p99,\n100 as name\n\n\nfrom buckets\nwhere bucket = 2\n),\nb3 as (\nselect\napprox_percentile(abs(routeEstimation - truth)/truth, 0.5)*100 as p50,\n\napprox_percentile(abs(routeEstimation - truth)/truth, 0.9)*100 as p90,\napprox_percentile(abs(routeEstimation - truth)/truth, 0.95)*100 as p95,\napprox_percentile(abs(routeEstimation - truth)/truth, 0.99)*100 as p99,\n100 as name\n\n\nfrom buckets\nwhere bucket = 3\n),\nb4 as (\nselect\napprox_percentile(abs(routeEstimation - truth)/truth, 0.5)*100 as p50,\n\napprox_percentile(abs(routeEstimation - truth)/truth, 0.9)*100 as p90,\napprox_percentile(abs(routeEstimation - truth)/truth, 0.95)*100 as p95,\napprox_percentile(abs(routeEstimation - truth)/truth, 0.99)*100 as p99,\n100 as name\n\n\nfrom buckets\nwhere bucket = 4\n)\n\nselect\narray(b0.p50, b1.p50, b2.p50, b3.p50, b4.p50) as p50,\narray(b0.p90, b1.p90, b2.p90, b3.p90, b4.p90) as p90,\narray(b0.p95, b1.p95, b2.p95, b3.p95, b4.p95) as p95,\narray(b0.p99, b1.p99, b2.p99, b3.p99, b4.p99) as p99\n\nfrom b0 join b1 on b0.name = b1.name\njoin b2 on b0.name=b2.name\njoin b3 on b0.name=b3.name\njoin b4 on b0.name=b4.name\n\n\"\"\"\nval percentiles = spark.sql(myQuery).collect()\n\n","user":"anonymous","dateUpdated":"2020-01-10T20:22:30+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"myQuery: String =\n\"\nwith b0 as (\nselect\napprox_percentile(abs(routeEstimation - truth)/truth, 0.5)*100 as p50,\n\napprox_percentile(abs(routeEstimation - truth)/truth, 0.9)*100 as p90,\napprox_percentile(abs(routeEstimation - truth)/truth, 0.95)*100 as p95,\napprox_percentile(abs(routeEstimation - truth)/truth, 0.99)*100 as p99,\n100 as name\n\nfrom buckets\nwhere bucket = 0\n),\n\nb1 as (\nselect\napprox_percentile(abs(routeEstimation - truth)/truth, 0.5)*100 as p50,\n\napprox_percentile(abs(routeEstimation - truth)/truth, 0.9)*100 as p90,\napprox_percentile(abs(routeEstimation - truth)/truth, 0.95)*100 as p95,\napprox_percentile(abs(routeEstimation - truth)/truth, 0.99)*100 as p99,\n100 as name\n\n\nfrom buckets\nwhere bucket = 1\n),\nb2 as (\nselect\napprox_percentile(abs(routeEstimation - truth)/truth, 0.5)*...percentiles: Array[org.apache.spark.sql.Row] = Array([WrappedArray(null, 6.2941463200675845, 5.2499245333439495, 4.9930456412017135, 5.151390765448786),WrappedArray(null, 19.297267517728034, 15.775190881238629, 14.495061553907906, 15.86805508177975),WrappedArray(null, 26.19164245592685, 21.17565790827214, 18.985251236677716, 21.51218543107253),WrappedArray(null, 46.66732376749736, 39.713835115194165, 42.198174848206804, 68.30923009765769)])\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["true/jobs/job?id=3865","true/jobs/job?id=3865","true/jobs/job?id=3865","true/jobs/job?id=3865","true/jobs/job?id=3865","true/jobs/job?id=3866","true/jobs/job?id=3866","true/jobs/job?id=3866","true/jobs/job?id=3866","true/jobs/job?id=3866","true/jobs/job?id=3867","true/jobs/job?id=3867","true/jobs/job?id=3867","true/jobs/job?id=3867","true/jobs/job?id=3867","true/jobs/job?id=3868","true/jobs/job?id=3868","true/jobs/job?id=3868","true/jobs/job?id=3868","true/jobs/job?id=3868","true/jobs/job?id=3869","true/jobs/job?id=3869","true/jobs/job?id=3869","true/jobs/job?id=3869","true/jobs/job?id=3869"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1578685549350_469050101","id":"20200110-191927_1777937916","dateCreated":"2020-01-10T19:45:49+0000","dateStarted":"2020-01-10T20:22:30+0000","dateFinished":"2020-01-10T20:22:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:123172"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578686848510_981478448","id":"20200110-200728_774678089","dateCreated":"2020-01-10T20:07:28+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:123173"}],"name":"/lucindaz/edgeToRouteV0.1.1","id":"2EY8T233S","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}